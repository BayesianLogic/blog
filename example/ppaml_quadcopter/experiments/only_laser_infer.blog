// Based on 2_bend noisy.
// state_mu is the (noisy) initial state.
// laser_observations is the first laser observation.

fixed RealMatrix state_mu = [-6.09833; -0.0897621; -0.000112593];
fixed RealMatrix state_sigma = 0.01 * eye(3);

random RealMatrix state ~ MultivarGaussian(state_mu, state_sigma);

fixed RealMatrix car_params = [0.299541; 0.0500507; 0.0; 0.257717];
fixed RealMatrix obstacles = [
    [-4.475, 1.45, 0.4],
    [-1.3, 1.025, 0.4],
    [-3.0, -1.55, 0.4],
    [0.65, -1.95, 0.4],
    [-1.95, -3.8, 0.4],
    [0.15, -5.625, 0.4]
];
fixed RealMatrix lasers_sigma = 0.01 * eye(361);

fixed RealMatrix laser_solns(
        Real laser_x, Real laser_y, Real laser_theta, RealMatrix obstacles)
    = LaserInterp();


random Real laser_x {
    = (toReal(state[0]) +
       toReal(car_params[0]) * cos(toReal(state[2])) +
       toReal(car_params[1]) * cos(toReal(state[2]) + 0.5 * pi))
};

random Real laser_y {
    = (toReal(state[1]) +
       toReal(car_params[0]) * sin(toReal(state[2])) +
       toReal(car_params[1]) * sin(toReal(state[2]) + 0.5 * pi))
};

random Real laser_theta = toReal(state[2]);

random RealMatrix laser_observations {
    ~ MultivarGaussian(
        laser_solns(laser_x, laser_y, laser_theta, obstacles),
        lasers_sigma)
};

// GROUND:
obs laser_observations = [
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 5.32366;
    5.20652; 5.13874; 5.13659; 5.09266; 5.06322; 5.04432; 5.04374; 5.04022;
    5.04905; 5.0702; 5.10243; 5.1038; 5.15328; 5.23244; 5.48505; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 3.06709; 3.07146; 3.01084;
    2.96091; 2.92275; 2.89827; 2.90354; 2.87982; 2.86499; 2.84394; 2.84145;
    2.83426; 2.84078; 2.83583; 2.83525; 2.8335; 2.83921; 2.84517; 2.85774;
    2.86598; 2.87919; 2.90034; 2.92238; 2.95583; 2.99071; 3.05409; 3.33627;
    10.0; 10.0; 10.0; 10.0; 10.0; 6.59459; 6.52954; 6.46855; 6.42945; 6.40426;
    6.38925; 6.38268; 6.39273; 6.40648; 6.43486; 6.48759; 6.56882; 6.82973;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 4.56757; 4.43523; 4.36665;
    4.32504; 4.30721; 4.2886; 4.27416; 4.26018; 4.27401; 4.27594; 4.27718;
    4.28649; 4.29623; 4.31538; 4.33507; 4.36983; 4.41561; 4.48626; 4.64508;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 2.00401; 1.84254; 1.84028; 1.782; 1.74974; 1.71904; 1.69926; 1.69783;
    1.67879; 1.66209; 1.6501; 1.63839; 1.63764; 1.6259; 1.61927; 1.61279;
    1.6065; 1.60637; 1.60044; 1.59824; 1.59616; 1.59133; 1.59181; 1.58867;
    1.59556; 1.59757; 1.59854; 1.60081; 1.60577; 1.612; 1.61841; 1.62002;
    1.62671; 1.6372; 1.64885; 1.66076; 1.66306; 1.6754; 1.69715; 1.71687;
    1.74477; 1.77714; 1.78044; 1.83412; 1.99053; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0;
    10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0; 10.0];


/*
// NOISY:
obs laser_observations = [
    9.99112; 10.1518; 9.96472; 10.0942; 10.0306; 10.0467; 10.0576; 10.0147;
    10.0248; 10.1041; 9.92387; 9.9082; 9.89024; 10.0892; 9.96818; 10.0904;
    10.0177; 9.9872; 10.0542; 10.0842; 10.0892; 10.2483; 10.0916; 10.12;
    10.0609; 10.0439; 10.1086; 9.96434; 10.0278; 10.0384; 10.2351; 9.9389;
    10.0557; 9.8775; 9.87645; 10.089; 9.91507; 10.0773; 9.92106; 10.1403;
    9.76055; 10.0453; 10.0433; 10.0836; 10.1515; 10.0739; 10.0093; 10.0195;
    10.0079; 10.0704; 10.0284; 9.99141; 10.0342; 10.0513; 10.0596; 9.99998;
    9.97684; 10.0724; 10.1458; 10.1059; 9.93182; 9.95667; 9.91674; 9.87357;
    10.0217; 10.0352; 9.9022; 9.8477; 9.79345; 9.86417; 10.115; 10.0853;
    10.1079; 9.91121; 9.9993; 10.0671; 10.067; 10.0597; 10.0264; 9.98759;
    10.0048; 10.0515; 5.22403; 5.24101; 5.12683; 5.08631; 5.15997; 5.0158;
    5.12577; 5.07404; 5.06636; 5.01376; 5.02826; 5.18655; 4.93637; 5.10793;
    5.25499; 5.37785; 9.90489; 9.8883; 10.0262; 9.99327; 9.9627; 10.0871;
    10.0318; 10.0479; 10.0319; 9.99507; 3.16966; 3.37584; 2.9762; 3.00049;
    3.03738; 3.091; 2.76963; 2.92976; 2.79277; 2.7931; 2.69354; 3.09668;
    2.86839; 2.78102; 2.66023; 2.66168; 2.85464; 2.85977; 3.03943; 2.86236;
    2.85527; 2.79503; 3.14345; 2.99083; 2.92165; 3.08306; 3.22666; 9.87075;
    10.0483; 10.0792; 10.0711; 9.89687; 6.59919; 6.58177; 6.53691; 6.5357;
    6.56482; 6.57846; 6.34427; 6.18941; 6.56314; 6.26824; 6.45965; 6.57841;
    6.98979; 10.0567; 9.8893; 9.9502; 9.74533; 10.1335; 10.1655; 9.98709;
    9.94385; 10.0421; 10.0377; 10.0875; 9.9222; 9.89828; 10.0212; 9.87701;
    9.8076; 10.1046; 10.0156; 10.0103; 9.97956; 10.0663; 10.0862; 9.81722;
    10.1458; 10.0705; 9.9629; 9.93532; 9.94897; 9.91343; 10.1665; 9.92292;
    10.1453; 10.0974; 9.90657; 9.91919; 10.1305; 9.85292; 9.8227; 10.004;
    10.0079; 10.0492; 10.0654; 9.94849; 10.0473; 4.40004; 4.53018; 4.25113;
    4.28116; 4.37335; 4.22752; 4.20528; 4.32295; 4.41131; 4.33851; 4.31093;
    4.26113; 4.36962; 4.10706; 4.119; 4.24227; 4.29144; 4.42043; 4.58056;
    10.1121; 10.126; 10.115; 10.1073; 10.0027; 10.0266; 10.0124; 10.063;
    9.98801; 10.0029; 9.97396; 10.1809; 9.95998; 9.97003; 9.93945; 9.92735;
    10.058; 9.93308; 10.0525; 10.0501; 9.98912; 10.0982; 10.0766; 9.98516;
    9.98273; 10.0959; 10.0152; 9.96086; 10.0043; 10.0369; 9.98806; 10.0551;
    10.1127; 9.99077; 9.99855; 10.1169; 10.0209; 1.8489; 1.77903; 1.85174;
    1.57384; 1.88631; 1.79471; 1.52312; 1.66396; 1.61406; 1.54994; 1.74775;
    1.64259; 1.64876; 1.59086; 1.50159; 1.82249; 1.6199; 1.66409; 1.52228;
    1.74092; 1.79667; 1.53008; 1.50714; 1.52771; 1.64773; 1.623; 1.63559;
    1.51077; 1.6481; 1.7745; 1.71953; 1.40376; 1.64063; 1.49152; 1.62863;
    1.75321; 1.75372; 1.61545; 1.69677; 1.60412; 1.76384; 1.71561; 1.98379;
    1.80654; 1.98831; 9.98531; 10.2139; 9.97562; 9.83308; 9.88611; 9.95925;
    9.86667; 10.1035; 9.96003; 10.112; 10.1505; 10.051; 10.1987; 9.85437;
    10.0424; 9.9402; 9.95207; 10.0513; 9.97947; 9.82434; 10.0792; 9.92583;
    9.68906; 9.92674; 10.1022; 9.81909; 9.9495; 10.0785; 10.0497; 10.0447;
    10.0375; 10.1026; 9.96022; 9.89837; 9.92919; 10.0884; 10.0211; 9.96716;
    9.95919; 9.9447; 10.0652; 9.89257; 10.0347; 10.0075; 10.2174; 10.1708;
    9.97744; 9.9607; 10.016; 10.1277; 9.96755; 9.95952; 9.94743; 9.94982;
    10.0254; 9.98185; 10.0474; 9.95918; 9.76251; 9.93913; 10.0674; 9.95075;
    10.2174];
*/

query state;
